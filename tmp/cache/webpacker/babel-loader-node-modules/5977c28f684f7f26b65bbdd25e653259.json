{"ast":null,"code":"var _jsxFileName = \"/Users/kotya/sequencer/app/javascript/components/controls/Knob.jsx\";\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (typeof call === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nimport _ from 'lodash';\nimport React from 'react';\n\nvar Knob =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Knob, _React$Component);\n\n  function Knob(props) {\n    var _this;\n\n    _classCallCheck(this, Knob);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Knob).call(this, props));\n\n    _this.startDrag = function (e) {\n      e.preventDefault();\n      var knob = e.target.getBoundingClientRect();\n      var pts = {\n        x: knob.left + knob.width / 2,\n        y: knob.top + knob.height / 2\n      };\n\n      var moveHandler = function moveHandler(e) {\n        _this.currentDeg = _this.getDeg(e.clientX, e.clientY, pts);\n        if (_this.currentDeg === _this.startAngle) _this.currentDeg--;\n        var newValue = Math.floor(_this.convertRange(_this.startAngle, _this.endAngle, _this.props.min, _this.props.max, _this.currentDeg));\n\n        _this.setState({\n          deg: _this.currentDeg\n        });\n\n        _this.props.onChange(newValue, _this.props.typeValue);\n      };\n\n      document.addEventListener(\"mousemove\", moveHandler);\n      document.addEventListener(\"mouseup\", function (e) {\n        document.removeEventListener(\"mousemove\", moveHandler);\n      });\n    };\n\n    _this.getDeg = function (cX, cY, pts) {\n      var x = cX - pts.x;\n      var y = cY - pts.y;\n      var deg = Math.atan(y / x) * 180 / Math.PI;\n\n      if (x < 0 && y >= 0 || x < 0 && y < 0) {\n        deg += 90;\n      } else {\n        deg += 360;\n      }\n\n      var finalDeg = Math.min(Math.max(_this.startAngle, deg), _this.endAngle);\n      return finalDeg;\n    };\n\n    _this.convertRange = function (oldMin, oldMax, newMin, newMax, oldValue) {\n      return (oldValue - oldMin) * (newMax - newMin) / (oldMax - oldMin) + newMin;\n    };\n\n    _this.renderTicks = function () {\n      var ticks = [];\n      var incr = _this.fullAngle / _this.props.numTicks;\n      var size = _this.margin + _this.props.size / 2;\n\n      for (var deg = _this.startAngle; deg <= _this.endAngle; deg += incr) {\n        var tick = {\n          deg: deg,\n          tickStyle: {\n            height: size - 10,\n            left: size,\n            top: size + 2,\n            transform: \"rotate(\" + deg + \"deg)\",\n            transformOrigin: \"top\"\n          }\n        };\n        ticks.push(tick);\n      }\n\n      return ticks;\n    };\n\n    _this.dcpy = function (o) {\n      return JSON.parse(JSON.stringify(o));\n    };\n\n    _this.fullAngle = props.degrees;\n    _this.startAngle = (360 - props.degrees) / 2;\n    _this.endAngle = _this.startAngle + props.degrees;\n    _this.margin = props.size * 0.15;\n    _this.currentDeg = Math.floor(_this.convertRange(props.min, props.max, _this.startAngle, _this.endAngle, props.value));\n    _this.state = {\n      deg: _this.currentDeg\n    };\n    return _this;\n  }\n\n  _createClass(Knob, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var kStyle = {\n        width: this.props.size,\n        height: this.props.size\n      };\n      var iStyle = this.dcpy(kStyle);\n      var oStyle = this.dcpy(kStyle);\n      oStyle.margin = this.margin;\n      oStyle.background = this.props.color;\n      iStyle.transform = \"rotate(\" + this.state.deg + \"deg)\";\n      return React.createElement(\"div\", {\n        className: \"full-knob\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"knob\",\n        style: kStyle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"ticks\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      }, this.props.numTicks ? this.renderTicks().map(function (tick, i) {\n        return React.createElement(\"div\", {\n          key: i,\n          className: \"tick\" + (tick.deg <= _this2.currentDeg ? \" active\" : \"\"),\n          style: tick.tickStyle,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 109\n          },\n          __self: this\n        });\n      }) : null), React.createElement(\"div\", {\n        className: \"knob outer\",\n        style: oStyle,\n        onMouseDown: this.startDrag,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"knob inner\",\n        style: iStyle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"grip\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      })))), React.createElement(\"p\", {\n        className: \"text-light-inset\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, this.props.children));\n    }\n  }]);\n\n  return Knob;\n}(React.Component);\n\nexport { Knob as default };\nKnob.defaultProps = {\n  size: 40,\n  min: 10,\n  max: 100,\n  numTicks: 0,\n  degrees: 360,\n  value: 0\n};","map":{"version":3,"sources":["/Users/kotya/sequencer/app/javascript/components/controls/Knob.jsx"],"names":["_","React","Knob","props","startDrag","e","preventDefault","knob","target","getBoundingClientRect","pts","x","left","width","y","top","height","moveHandler","currentDeg","getDeg","clientX","clientY","startAngle","newValue","Math","floor","convertRange","endAngle","min","max","setState","deg","onChange","typeValue","document","addEventListener","removeEventListener","cX","cY","atan","PI","finalDeg","oldMin","oldMax","newMin","newMax","oldValue","renderTicks","ticks","incr","fullAngle","numTicks","size","margin","tick","tickStyle","transform","transformOrigin","push","dcpy","o","JSON","parse","stringify","degrees","value","state","kStyle","iStyle","oStyle","background","color","map","i","children","Component","defaultProps"],"mappings":"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","sourcesContent":["import _ from 'lodash'\nimport React from 'react'\n\nexport default class Knob extends React.Component {\n  constructor(props) {\n    super(props);\n    this.fullAngle = props.degrees;\n    this.startAngle = (360 - props.degrees) / 2;\n    this.endAngle = this.startAngle + props.degrees;\n    this.margin = props.size * 0.15;\n    this.currentDeg = Math.floor(\n      this.convertRange(\n        props.min,\n        props.max,\n        this.startAngle,\n        this.endAngle,\n        props.value\n      )\n    );\n    this.state = { deg: this.currentDeg };\n  }\n\n  startDrag = e => {\n    e.preventDefault();\n    const knob = e.target.getBoundingClientRect();\n    const pts = {\n      x: knob.left + knob.width / 2,\n      y: knob.top + knob.height / 2\n    };\n    const moveHandler = e => {\n      this.currentDeg = this.getDeg(e.clientX, e.clientY, pts);\n      if (this.currentDeg === this.startAngle) this.currentDeg--;\n      let newValue = Math.floor(\n        this.convertRange(\n          this.startAngle,\n          this.endAngle,\n          this.props.min,\n          this.props.max,\n          this.currentDeg\n        )\n      );\n      this.setState({ deg: this.currentDeg });\n      this.props.onChange(newValue, this.props.typeValue);\n    };\n    document.addEventListener(\"mousemove\", moveHandler);\n    document.addEventListener(\"mouseup\", e => {\n      document.removeEventListener(\"mousemove\", moveHandler);\n    });\n  };\n\n  getDeg = (cX, cY, pts) => {\n    const x = cX - pts.x;\n    const y = cY - pts.y;\n    let deg = Math.atan(y / x) * 180 / Math.PI;\n    if ((x < 0 && y >= 0) || (x < 0 && y < 0)) {\n      deg += 90;\n    } else {\n      deg += 360;\n    }\n    let finalDeg = Math.min(Math.max(this.startAngle, deg), this.endAngle);\n    return finalDeg;\n  };\n\n  convertRange = (oldMin, oldMax, newMin, newMax, oldValue) => {\n    return (oldValue - oldMin) * (newMax - newMin) / (oldMax - oldMin) + newMin;\n  };\n\n  renderTicks = () => {\n    let ticks = [];\n    const incr = this.fullAngle / this.props.numTicks;\n    const size = this.margin + this.props.size / 2;\n    for (let deg = this.startAngle; deg <= this.endAngle; deg += incr) {\n      const tick = {\n        deg: deg,\n        tickStyle: {\n          height: size - 10,\n          left: size,\n          top: size +2,\n          transform: \"rotate(\" + deg + \"deg)\",\n          transformOrigin: \"top\"\n        }\n      };\n      ticks.push(tick);\n    }\n    return ticks;\n  };\n\n  dcpy = o => {\n    return JSON.parse(JSON.stringify(o));\n  };\n\n  render() {\n    let kStyle = {\n      width: this.props.size,\n      height: this.props.size\n    };\n    let iStyle = this.dcpy(kStyle);\n    let oStyle = this.dcpy(kStyle);\n    oStyle.margin = this.margin;\n    oStyle.background = this.props.color\n    iStyle.transform = \"rotate(\" + this.state.deg + \"deg)\";\n\n    return (\n      <div className=\"full-knob\">\n        <div className=\"knob\" style={kStyle}>\n          <div className=\"ticks\">\n            {this.props.numTicks\n              ? this.renderTicks().map((tick, i) => (\n                  <div\n                    key={i}\n                    className={\n                      \"tick\" + (tick.deg <= this.currentDeg ? \" active\" : \"\")\n                    }\n                    style={tick.tickStyle}\n                  />\n                ))\n              : null}\n          </div>\n          <div className=\"knob outer\" style={oStyle} onMouseDown={this.startDrag}>\n            <div className=\"knob inner\" style={iStyle}>\n              <div className=\"grip\" />\n            </div>\n          </div>\n        </div>\n        <p className=\"text-light-inset\">{this.props.children}</p>\n      </div>\n\n    );\n  }\n}\nKnob.defaultProps = {\n  size: 40,\n  min: 10,\n  max: 100,\n  numTicks: 0,\n  degrees: 360,\n  value: 0\n};\n"]},"metadata":{},"sourceType":"module"}